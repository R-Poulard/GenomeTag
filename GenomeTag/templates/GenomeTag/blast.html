{% extends "base.html" %}
{% block title %}{% endblock %}
{% block content %}
{% load static %}
<script>
  function displayPosition() {
    console.log("Function displayPosition() called");
    var positionId = document.getElementById("id_position").value;
    var startPosition = document.getElementById("id_position").options[document.getElementById("id_position").selectedIndex].getAttribute('data-start');
    var endPosition = document.getElementById("id_position").options[document.getElementById("id_position").selectedIndex].getAttribute('data-end');
    var positionData = "Start: " + startPosition + ", End: " + endPosition;
    document.getElementById("position_info").textContent = positionData;
  }

  function showLoading() {
    document.getElementById("loading").style.display = "block";
    setTimeout(function() {
      document.getElementById("loading").style.display = "none";
    }, 3000); // Hide the loading spinner after 3 seconds (adjust as needed)
  }

  window.addEventListener('load', displayPosition);
</script>

<div class="center-container2">
  <h1>Blast Page</h1>
  <form method="post" onsubmit="showLoading()">
    {% csrf_token %}
    <label for="blast_type">Blast Type:</label>
    <select id="blast_type" name="blast_type">
      <option value="blastn">blastn</option>
      <option value="blastp">blastp</option>
      <option value="blastx">blastx</option>
      <option value="tblastn">tblastn</option>
    </select><br><br>
    <label for="database">Database :</label>
    <select id="database" name="database">
      <option value="nr">nr</option>
      {% if type == "peptide" %}
      <option value="pdb">pdb</option>
      <option value="swissprot">swissprot</option>
      <option value="landmark">landmark</option>
      {% endif %}
    </select><br><br>
    {% if type == "annotation" %}
    <label for="id_position">Select Position:</label>
    <select id="id_position" name="position" onchange="displayPosition()">
      {% for position in annotation.position.all %}
      <option value="{{ position.id }}" data-start="{{ position.start }}" data-end="{{ position.end }}">{{ position }}</option>
      {% endfor %}
    </select>
    <div id="position_info"></div>
    {% endif %}
    <button type="submit">Submit</button>
  </form>
  <div id="loading" style="display: none;">Processing... <img src="{% static 'GenomeTag/Images/loading.gif' %}" alt="Loading"></div>
</div>
{% endblock %}
